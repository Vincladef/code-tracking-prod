<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Habitudes &amp; Pratique</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî•</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Pastels par section (par d√©faut = daily / bleu doux) */
      --accent-50:  #ECF7FF;
      --accent-200: #CFEBFF;
      --accent-400: #9FD7FF;
      --accent-600: #60BFFD;
      --accent-700: #3EA6EB;

      --card-bg: #ffffff;
      --page-bg: #F6F7FB;
      --text:    #334155; /* slate-700 */
      --muted:   #94A3B8; /* slate-400 */
      --ring:    var(--accent-400);
    }
    /* Pratique = vert doux */
    [data-section="practice"]{
      --accent-50:#F1FBF4; --accent-200:#D8F3E0; --accent-400:#BEE6C8; --accent-600:#8ED6A2; --accent-700:#63C582;
    }
    /* Objectifs = violet doux */
    [data-section="goals"]{
      --accent-50:#F7F3FF; --accent-200:#E9DFFF; --accent-400:#E3D0FF; --accent-600:#C7A7FF; --accent-700:#A884FF;
    }

    body { font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    body{ background:var(--page-bg); color:var(--text); }

    /* Cards blanches, coins 2xl, ombre douce */
    .card{ background:var(--card-bg); border:1px solid #E5E7EB; border-radius:1rem; box-shadow: 0 8px 24px rgba(16,24,40,.06); }

    /* Champs clairs + anneau pastel */
    input, textarea, select{
      background:#fff; border:1px solid #E5E7EB; color:var(--text); border-radius:.75rem; padding:.625rem .75rem;
    }
    input:focus, textarea:focus, select:focus{ outline:none; border-color:var(--ring); box-shadow:0 0 0 3px var(--accent-50); }

    /* Onglets (pills) + √©tat actif color√© */
    .tabs{ display:flex; gap:.5rem; align-items:center; overflow-x:auto; flex-wrap:nowrap; -webkit-overflow-scrolling:touch; }
    .tabs::-webkit-scrollbar{ display:none; }
    .tab{ border:1px solid #E5E7EB; background:#fff; border-radius:999px; padding:.5rem .875rem; font-size:.9rem; display:inline-flex; gap:.5rem; align-items:center; white-space:nowrap; flex:0 0 auto; }
    .tab[aria-current="page"]{ background:var(--accent-50); border-color:var(--accent-400); color:#0B4B66; }

    /* cache le bouton Admin partout */
    [data-nav="admin"] { display: none !important; }

    /* Boutons */
    .btn{ border-radius:.75rem; padding:.625rem 1rem; font-weight:600; }
    .btn-primary{ background:var(--accent-600); color:#fff; }
    .btn-primary:hover{ background:var(--accent-700); }
    .btn-ghost{ background:transparent; border:1px solid var(--accent-200); color:#334155; }
    .btn-ghost:hover{ background:var(--accent-50); }

    /* Animation de changement d‚Äôonglet */
    @keyframes fadeSlideIn{ from{ opacity:0; transform:translateY(6px);} to{ opacity:1; transform:translateY(0);} }
    .route-enter{ animation: fadeSlideIn .25s ease-out; }

    /* Sidebar cach√©e par d√©faut (mode admin != user) */
    #sidebar{ display:none; }

    /* Titre un peu plus petit sur mobile */
    @media (max-width: 640px){
      header h1{ font-size:1rem; }
    }

    /* utilitaire pour masquer la scrollbar (d√©j√† utilis√© ci-dessus) */
    .no-scrollbar::-webkit-scrollbar{ display:none; }
    .no-scrollbar{ -ms-overflow-style:none; scrollbar-width:none; }

    /* Boutons de jours (Journalier) */
    .day-btn[data-today="1"] {
      /* l√©ger surlignage si ce n'est pas le jour s√©lectionn√© */
      box-shadow: inset 0 0 0 2px var(--accent-200);
    }

    /* Journalier ‚Äî cat√©gories */
    .daily-category {
      position: relative;
      background:#fff;
      border-radius:1.2rem;
      border:1px solid rgba(148, 163, 184, .25);
      padding:1.1rem 1.25rem 1.25rem;
      box-shadow:0 10px 24px rgba(15,23,42,.08);
      overflow:hidden;
    }
    .daily-category::before {
      content:"";
      position:absolute;
      inset:0;
      border-radius:inherit;
      border-left:6px solid var(--accent-400);
      pointer-events:none;
      opacity:.25;
    }
    .daily-category__header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:.75rem;
      margin-bottom:.9rem;
      position:relative;
      z-index:1;
    }
    .daily-category__name {
      font-weight:700;
      font-size:1.05rem;
      text-transform:capitalize;
    }
    .daily-category__count {
      font-size:.75rem;
      color:var(--muted);
      background:var(--accent-50);
      border:1px solid var(--accent-200);
      border-radius:999px;
      padding:.2rem .6rem;
    }
    .daily-category__items {
      display:grid;
      gap:.8rem;
      position:relative;
      z-index:1;
    }
    .daily-category__low {
      border-radius:1rem;
      border:1px dashed rgba(148,163,184,.35);
      background:rgba(241,245,249,.75);
      padding:.75rem;
    }
    .daily-category__low[open] {
      background:#fff;
    }
    .daily-category__low-summary {
      list-style:none;
      cursor:pointer;
      font-size:.8rem;
      font-weight:600;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:.35rem;
    }
    .daily-category__low-summary::-webkit-details-marker {
      display:none;
    }
    .daily-category__items--nested {
      margin-top:.65rem;
      display:grid;
      gap:.75rem;
    }
    .daily-consigne {
      background:#fff;
      border-radius:1rem;
      border:1px solid rgba(148,163,184,.25);
      box-shadow:0 8px 20px rgba(15,23,42,.06);
      padding:.9rem 1rem;
      display:grid;
      gap:.75rem;
    }
    .daily-consigne__top {
      display:flex;
      flex-wrap:wrap;
      align-items:flex-start;
      justify-content:space-between;
      gap:.75rem;
    }
    .daily-consigne__title {
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:.5rem;
    }
    .daily-consigne__field {
      display:block;
    }

    /* Pastilles de priorit√© */
    .prio-chip {
      display:inline-flex; align-items:center; gap:.4rem;
      padding:.15rem .5rem; border-radius:999px;
      font-size:.75rem; border:1px solid transparent;
    }
    .prio-high   { background:#FEE2E2; border-color:#FCA5A5; color:#B91C1C; } /* rouge doux */
    .prio-medium { background:#FEF3C7; border-color:#FCD34D; color:#92400E; } /* ambre doux */
    .prio-low    { background:#E0F2FE; border-color:#BAE6FD; color:#075985; } /* bleu doux */

    .btn-saved{ background:#22C55E; } /* vert doux rapide pour le flash */

    /* Objectifs */
    .goal-header{ display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap; margin-bottom:12px; }
    .goal-timeline{ display:grid; gap:12px; padding:8px 0; }
    .goal-month{ background:#fff; border-radius:16px; box-shadow:0 10px 28px rgba(79,70,229,.08); padding:16px; border:1px solid rgba(148,163,184,.2); }
    .goal-month--current{ border-color:var(--accent-400); box-shadow:0 12px 32px rgba(99,102,241,.14); }
    .goal-month__header{ display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:1rem; }
    .goal-month__title{ margin:0; font-weight:700; font-size:1.15rem; text-transform:capitalize; }
    .goal-month__add{ padding:.35rem .9rem; border-radius:999px; font-size:.85rem; }
    .goal-monthly{ border:1px dashed rgba(148,163,184,.35); background:rgba(236,233,255,.6); border-radius:14px; padding:.85rem 1rem; margin-bottom:1rem; }
    .goal-monthly__title{ font-size:.85rem; font-weight:600; color:#5b21b6; text-transform:uppercase; letter-spacing:.03em; }
    .goal-week{ padding:10px 0; border-top:1px dashed #e5e7eb; }
    .goal-week:first-of-type{ border-top:none; padding-top:0; }
    .goal-week__header{ display:flex; align-items:center; justify-content:space-between; gap:.5rem; margin-bottom:.45rem; }
    .goal-week__label{ font-size:.82rem; }
    .goal-week__add{ padding:.25rem .75rem; font-size:.78rem; border-radius:999px; }
    .goal-row{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:6px 10px; border-radius:12px; transition:background .15s ease, box-shadow .15s ease; border-left:4px solid transparent; }
    .goal-row:hover{ box-shadow:0 6px 14px rgba(15,23,42,.08); }
    .goal-row--positive{ background:#ecfdf5; border-left-color:#22c55e; }
    .goal-row--neutral{ background:#fefce8; border-left-color:#fbbf24; }
    .goal-row--negative{ background:#fef2f2; border-left-color:#f87171; }
    .goal-row--none{ background:#f8fafc; border-left-color:#94a3b8; }
    .goal-title{ font-weight:600; flex:1; }
    .goal-quick{ min-width:140px; }
    .goal-empty{ padding:1rem; border-radius:.75rem; background:var(--accent-50); }
    .select-compact{ font-size:.95rem; padding:4px 8px; border-radius:10px; border:1px solid #e5e7eb; background:#fff; }
    .select-compact:focus{ outline:none; border-color:var(--accent-400); box-shadow:0 0 0 3px var(--accent-50); }
    .week-picker{ display:flex; gap:.5rem; }
    .week-picker button.is-active{ background:var(--accent-600); color:#fff; border-color:var(--accent-600); }
    .goal-month-pill{ display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .75rem; border-radius:999px; background:var(--accent-50); border:1px solid var(--accent-200); font-size:.85rem; font-weight:600; color:#4338ca; }

    .history-scroll{ overflow-x:auto; -webkit-overflow-scrolling:touch; }
    .history-table{ min-width:720px; }
    .goal-modal{ position:fixed; inset:0; background:rgba(15,23,42,.18); display:grid; place-items:center; padding:1rem; z-index:50; }
    .goal-modal-card{ background:#fff; border-radius:1rem; padding:1.25rem 1.5rem; box-shadow:0 24px 48px rgba(15,23,42,.16); width:min(720px,95vw); max-height:90vh; overflow:auto; }
    .goal-modal-header{ display:flex; align-items:flex-start; justify-content:space-between; gap:1rem; }
    .goal-modal-title{ font-weight:700; font-size:1.1rem; }
    .goal-form{ display:grid; gap:1rem; margin-top:1rem; }
    .goal-field{ display:grid; gap:.4rem; }
    .goal-label{ font-size:.85rem; color:var(--muted); }
    .goal-input{ width:100%; }
    .goal-actions{ display:flex; justify-content:flex-end; gap:.5rem; }
    .goal-list{ margin-top:.5rem; padding-left:1.25rem; display:grid; gap:.35rem; list-style:disc; }

  </style>
</head>
<body class="min-h-screen">
  <div class="flex min-h-screen flex-col">
    <header class="border-b border-gray-200 bg-white">
      <div class="mx-auto w-full max-w-5xl px-4 py-4
            flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
        <h1 class="text-lg sm:text-xl font-semibold">
          Habitudes &amp; Pratique
          <span id="user-badge" style="margin-left:.5rem;color:#94a3b8;font-weight:600;">
            ‚Äî <span data-username>‚Ä¶</span>
          </span>
        </h1>
        <nav class="tabs w-full sm:w-auto overflow-x-auto no-scrollbar">
          <button class="tab" data-route="#/admin" data-nav="admin"><span>üõ†Ô∏è</span><span>Admin</span></button>
          <button class="tab" data-route="#/daily"><span>üìÖ</span><span>Journalier</span></button>
          <button class="tab" data-route="#/practice"><span>‚ö°</span><span>Pratique</span></button>
          <button class="tab" data-route="#/goals"><span>üéØ</span><span>Objectifs</span></button>
        </nav>
      </div>
    </header>

    <main class="flex-1">
      <div class="mx-auto flex w-full max-w-5xl flex-col gap-4 px-4 py-6">
        <aside id="sidebar"></aside>
        <div id="view-root">Chargement‚Ä¶</div>
      </div>
    </main>

    <footer class="border-t border-gray-200 py-6 text-center text-sm text-[var(--muted)]">
      &copy; Habitudes &amp; Pratique
    </footer>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-messaging-compat.js"></script>
  <script src="schema.js"></script>
  <script src="modes.js"></script>
  <script src="goals.js"></script>
  <script src="app.js"></script>
  <script>
    (function initApp() {
      if (!window.firebase) {
        console.error("Firebase non charg√©");
        return;
      }
      const cfg = {
        apiKey: "AIzaSyAQcvZ9a2j4MHF04RjMHIey0R_iwnjZf4o",
        authDomain: "tracking-d-habitudes.firebaseapp.com",
        projectId: "tracking-d-habitudes",
        storageBucket: "tracking-d-habitudes.firebasestorage.app",
        messagingSenderId: "739389871966",
        appId: "1:739389871966:web:684e26dbdfb0c0a69221cf",
        measurementId: "G-ZPHWB5DKWF"
      };
      const app = firebase.initializeApp(cfg);
      const db = firebase.firestore(app);
      if (typeof startRouter === "function") {
        startRouter(app, db);
      } else {
        console.error("startRouter indisponible");
      }
    })();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</body>
</html>
